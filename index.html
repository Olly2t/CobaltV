<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secure Uploads</title>
  <style>
    body { font-family: sans-serif; background: #f2f2f2; padding: 20px; }
    .upload-form, .item { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
    .item img { max-width: 150px; display: block; margin-bottom: 10px; }
  </style>
</head>
<body>

  <!-- Upload Form (Only visible to localhost via JS check) -->
  <div id="upload-section" class="upload-form" style="display: none;">
    <h2>Upload File</h2>
    <form action="upload.php" method="POST" enctype="multipart/form-data">
      <label>Title: <input type="text" name="title" required></label><br><br>
      <label>Description: <textarea name="description" required></textarea></label><br><br>
      <label>Thumbnail: <input type="file" name="thumbnail" accept="image/*" required></label><br><br>
      <label>File: <input type="file" name="file" required></label><br><br>
      <button type="submit">Upload</button>
    </form>
  </div>

  <h2>Uploaded Files</h2>
  <div id="items"></div>

  <script>
    // Show upload section only if localhost
    if (['192.168.7.10', '::1'].includes(location.hostname)) {
      document.getElementById('upload-section').style.display = 'block';
    }

    // Load items
    fetch('data.json')
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById('items');
        data.forEach(item => {
          const div = document.createElement('div');
          div.className = 'item';
          div.innerHTML = `
            <img src="${item.thumbnail}" alt="Thumbnail">
            <h3>${item.title}</h3>
            <p>${item.description}</p>
            <a href="${item.file}" download>Download File</a>
          `;
          container.appendChild(div);
        });
      });
  </script>

</body>
</html>
